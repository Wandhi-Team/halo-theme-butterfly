<layout
  xmlns:th="https://www.thymeleaf.org"
  th:replace="~{core/layout :: layout (
  page = 'post',
  title = ${post.spec.title},
  css_pin = ~{::css_pin},
  js_pin = ~{::js_pin},
  header = ~{::header},
  main = ~{::main}
  )}"
>
  <!--/* css */-->
  <th:block th:fragment="css_pin">
    <style
      id="pageStyle"
      xmlns:th="https://www.thymeleaf.org"
      th:inline="css"
      th:with="above_background = ${not #strings.isEmpty(post.spec.cover) ? post.spec.cover : (theme.config.loading.img.random_enable ? theme.config.loading.img.random_link  : ''  )}">
      .above {
        --above-background: /*[(${'url('+above_background+')'})]*/ '';
      }
    </style>
  </th:block>

  <!--/* js */-->
  <th:block th:fragment="js_pin">
    <script id="pageScript" th:inline="javascript">
      Object.assign(window.THEME_CONFIG.attrs, {
        enable_code_copy: /*[[${#annotations.getOrDefault(post, 'enable_code_copy','true')}]]*/ true,
      });
    </script>
  </th:block>


  <th:block th:fragment="header">
    <header th:class="${not theme.config.post.enable_above ? 'header dp' : 'header'}">
      <!--/* 导航栏 */-->
      <th:block th:replace="~{modules/nav}"/>

      <!--第一屏内容-->
      <section class="above" th:if="${theme.config.post.enable_above}">
        <div class="above-info">
          <h1 class="post-title" th:text="${post.spec.title}"></h1>
          <ul class="post-meta">
            <li class="row">
        <span class="wp category" th:if="${not #lists.isEmpty(post.categories)}">
            <i class="fa-solid fa-layer-group"></i>
            <span class="cys">
              <th:block th:each="cy : ${post.categories}">
                <a class="lk" th:href="${cy.status.permalink}" th:text="${cy.spec.displayName}"></a>
              </th:block>
            </span>
        </span>

              <span class="wp tag" th:if="${not #lists.isEmpty(post.categories)}">
           <i class="fa-duotone fa-tags"></i>
            <span class="cys">
              <th:block th:each="cy : ${post.tags}">
                <a class="lk" th:href="${cy.status.permalink}" th:text="${cy.spec.displayName}"></a>
              </th:block>
            </span>
        </span>
            </li>

            <li class="row">
        <span class="wp publishTime">
            <i class="fa-solid fa-calendar-days"></i>
            <time th:text="'发布于 '+${#dates.format(post.spec.publishTime, 'yyyy-MM-dd')}"></time>
        </span>

              <span class="wp lastModifyTime">
            <i class="fas fa-history fa-fw"></i>
            <time th:text="'更新于 '+${#dates.format(post.status.lastModifyTime, 'yyyy-MM-dd')}"></time>
        </span>
            </li>

            <li class="row" th:with="leg = ${#strings.length(#strings.trim(post.content.content))}">
        <span class="wp wordCount">
          <i class="fa-solid fa-list-ol"></i>
          <span th:text="'字数总计 '+${leg}"></span>
        </span>

              <span class="wp clock">
           <i class="fa-regular fa-clock"></i>
          <span th:text="'阅读时长 '+${leg/800}+'分钟'"></span>
        </span>

              <span class="wp visit">
          <i class="far fa-eye fa-fw"></i>
          <span th:text="'阅读量 '+${post.stats.visit}"></span>
        </span>
            </li>
          </ul>
        </div>
      </section>
    </header>
  </th:block>

  <!--/* 內容 */-->
  <th:block th:fragment="main">
    <th:block th:replace="~{modules/render::post}"/>
    <th:block th:replace="~{modules/aside::aside_post}"/>
  </th:block>
</layout>